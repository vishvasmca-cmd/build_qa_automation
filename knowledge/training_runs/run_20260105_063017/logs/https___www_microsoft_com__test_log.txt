ğŸš€ Starting autonomous test for https://www.microsoft.com/
Both GOOGLE_API_KEY and GEMINI_API_KEY are set. Using GOOGLE_API_KEY.
Both GOOGLE_API_KEY and GEMINI_API_KEY are set. Using GOOGLE_API_KEY.
Both GOOGLE_API_KEY and GEMINI_API_KEY are set. Using GOOGLE_API_KEY.
Both GOOGLE_API_KEY and GEMINI_API_KEY are set. Using GOOGLE_API_KEY.
ğŸ¤– CI Environment detected: Forcing Headless Mode
ğŸš€ Explorer: Starting Strategy 2026. Goal: Autonomous smoke test: Navigate site, explore main features, verify key elements

--- Step 1 ---
ğŸ” Mining Page (2026 Strategy): https://www.microsoft.com/en-us/
ğŸ“ On Page: Microsoft - Official Home Page
ğŸ¤” State: login_screen
ğŸ“¡ Sending 523 elements to the Planner...
ğŸ’­ Thought: The goal is to navigate the site and explore main features. I will start by clicking on the first main navigation link, which is 'Microsoft 365'. I will skip login since no test data is available.
   âœ¨ Refined: page.get_by_role("link", { name: "Microsoft 365" })
ğŸ–±ï¸ Clicking ID=3 (Microsoft 365)
ğŸ’¾ Trace saved to projects/https___www_microsoft_com__regression/outputs/trace.json
ğŸ’¾ Passive Collection: 523 elements saved.

--- Step 2 ---
ğŸ” Mining Page (2026 Strategy): https://www.microsoft.com/en-us/microsoft-365
ğŸ“ On Page: Microsoft 365
ğŸ¤” State: login_screen
ğŸ“¡ Sending 0 elements to the Planner...
ğŸ’­ Thought: I am on the login screen of Microsoft 365. The goal is to navigate the site and explore main features. Since I don't have any login credentials in `test_data`, I will skip logging in and instead explore publicly available features, such as the pricing page. The page context mentions a 'See plans and pricing' button.
ğŸ’¾ Trace saved to projects/https___www_microsoft_com__regression/outputs/trace.json
ğŸ’¾ Passive Collection: 0 elements saved.
âš ï¸ Action failed. Retrying...

--- Step 3 ---
ğŸ” Mining Page (2026 Strategy): https://www.microsoft.com/en-us/microsoft-365
ğŸ“ On Page: Microsoft 365
ğŸ¤” State: login_screen
ğŸ“¡ Sending 609 elements to the Planner...
ğŸ’­ Thought: The goal is to autonomously smoke test the Microsoft 365 website by navigating the site and exploring the main features. I am currently on the homepage. The previous action failed, so I need to find a different element to interact with. Since I am not logged in and do not have credentials, I will start by exploring the 'Products' menu to explore the features. I'll click on the 'Products' button to see a list of available Microsoft products.
   âœ¨ Refined: page.get_by_role("button", { name: "Products" })
ğŸ–±ï¸ Clicking ID=5 (Products)
ğŸ’¾ Trace saved to projects/https___www_microsoft_com__regression/outputs/trace.json
ğŸ’¾ Passive Collection: 609 elements saved.

--- Step 4 ---
ğŸ” Mining Page (2026 Strategy): https://www.microsoft.com/en-us/microsoft-365
ğŸ“ On Page: Microsoft 365
ğŸ¤” State: login_screen
ğŸ“¡ Sending 641 elements to the Planner...
ğŸ’­ Thought: The goal is to explore the main features of the site. I have already clicked on 'Microsoft 365' and 'Products'. Now, I will try clicking on 'Resources' button to further explore the site's features.
   âœ¨ Refined: page.get_by_role("button", { name: "Resources" })
ğŸ–±ï¸ Clicking ID=39 (Resources)
ğŸ’¾ Trace saved to projects/https___www_microsoft_com__regression/outputs/trace.json
ğŸ’¾ Passive Collection: 641 elements saved.

--- Step 5 ---
ğŸ” Mining Page (2026 Strategy): https://www.microsoft.com/en-us/microsoft-365
ğŸ“ On Page: Microsoft 365
ğŸ¤” State: login_screen
ğŸ“¡ Sending 619 elements to the Planner...
ğŸ’­ Thought: The page is a login screen for Microsoft 365. The goal is to navigate and explore the site. Since there are no credentials available, I will skip the sign-in process and explore publicly available options. There's a 'Plans and pricing' link available, which I can use to explore the website's features.
   âš ï¸ Refinement timeout/error: Locator.evaluate: Error: strict mode violation: lo...
   âœ¨ Refined: page.get_by_text('See plans and pricing for Microsoft 365')
ğŸ–±ï¸ Clicking ID=29 (See plans and pricing for Microsoft 365)
   ğŸ‘‰ Locator failed. Using coordinate fallback.
ğŸ’¾ Trace saved to projects/https___www_microsoft_com__regression/outputs/trace.json
ğŸ’¾ Passive Collection: 619 elements saved.

--- Step 6 ---
ğŸ” Mining Page (2026 Strategy): https://www.microsoft.com/en-us/microsoft-365
ğŸ“ On Page: Microsoft 365
ğŸ¤” State: login_screen
ğŸ“¡ Sending 609 elements to the Planner...
ğŸ’­ Thought: The goal is to navigate the site and explore the main features. I've already clicked on 'Products', 'Resources', and 'See plans and pricing for Microsoft 365'. Now I will click the 'Support' button to explore another main feature.
   âš ï¸ Refinement timeout/error: Locator.evaluate: Error: strict mode violation: lo...
   âœ¨ Refined: page.get_by_text('Support')
ğŸ–±ï¸ Clicking ID=8 (Support)
   ğŸ‘‰ Locator failed. Using coordinate fallback.
ğŸ’¾ Trace saved to projects/https___www_microsoft_com__regression/outputs/trace.json
ğŸ’¾ Passive Collection: 609 elements saved.

--- Step 7 ---
ğŸ” Mining Page (2026 Strategy): https://www.microsoft.com/en-us/microsoft-365
ğŸ“ On Page: Microsoft 365 | Home Page
ğŸ¤” State: login_screen
ğŸ“¡ Sending 614 elements to the Planner...
ğŸ’­ Thought: I'm on the Microsoft 365 home page. I've already clicked Products, Resources, the plans and pricing link, and Support. Next I will click the 'For individuals' button to explore that section of the site.
   âš ï¸ Refinement timeout/error: Locator.evaluate: Error: strict mode violation: lo...
   âœ¨ Refined: page.get_by_text('For individuals')
ğŸ–±ï¸ Clicking ID=9 (For individuals)
   ğŸ‘‰ Locator failed. Using coordinate fallback.
ğŸ’¾ Trace saved to projects/https___www_microsoft_com__regression/outputs/trace.json
ğŸ’¾ Passive Collection: 614 elements saved.

--- Step 8 ---
ğŸ” Mining Page (2026 Strategy): https://www.microsoft.com/en-us/microsoft-365
ğŸ“ On Page: Microsoft 365
ğŸ¤” State: login_screen
ğŸ“¡ Sending 614 elements to the Planner...
ğŸ’­ Thought: The goal is to smoke test the site. I've already clicked several buttons on the page. I'm now going to click the 'Plans and pricing' link to see the available plans.
   âš ï¸ Refinement timeout/error: Locator.evaluate: Error: strict mode violation: lo...
   âœ¨ Refined: page.get_by_text('Plans and pricing')
ğŸ–±ï¸ Clicking ID=6 (Plans and pricing)
   ğŸ‘‰ Locator failed. Using coordinate fallback.
ğŸ’¾ Trace saved to projects/https___www_microsoft_com__regression/outputs/trace.json
ğŸ’¾ Passive Collection: 614 elements saved.

--- Step 9 ---
ğŸ” Mining Page (2026 Strategy): https://www.microsoft.com/en-us/microsoft-365
ğŸ“ On Page: Microsoft 365 for Business
ğŸ¤” State: login_screen
ğŸ“¡ Sending 609 elements to the Planner...
ğŸ’­ Thought: I have clicked several links and buttons already. The page is still the same and there are no credentials available. I will explore the 'Products' menu again.
   âš ï¸ Refinement timeout/error: Locator.evaluate: Timeout 5000ms exceeded.
Call lo...
   âœ¨ Refined: page.get_by_text('Products')
ğŸ–±ï¸ Clicking ID=5 (Products)
   ğŸ‘‰ Locator failed. Using coordinate fallback.
ğŸ’¾ Trace saved to projects/https___www_microsoft_com__regression/outputs/trace.json
ğŸ’¾ Passive Collection: 609 elements saved.

--- Step 10 ---
ğŸ” Mining Page (2026 Strategy): https://www.microsoft.com/en-us/microsoft-365/business/microsoft-365-plans-and-pricing
   âš ï¸ Error mining main frame: Page.evaluate: Execution context was destroyed, most likely because of a navigation
ğŸ“ On Page: Microsoft 365 Plans and Pricing
ğŸ¤” State: login_screen
ğŸ“¡ Sending 0 elements to the Planner...
ğŸ’­ Thought: I am on the Microsoft 365 Plans and Pricing page. The goal is to explore the site and verify key elements. I have already clicked through several navigation elements and product links. Given the page context (plans and pricing), and since I do not have credentials for login, I will now explore publicly accessible elements, specifically those related to different plans and their features. Since the element list is empty, I cannot click on any specific element. I will explore the resources that are available in the page without requiring any authentication.
âœ… Goal Achieved!
ğŸ’¾ Trace saved to projects/https___www_microsoft_com__regression/outputs/trace.json
  File "/home/runner/work/build_qa_automation/build_qa_automation/core/refiner.py", line 71
    - Syntax: `smart_action(page, """playwright_locator_string""", "action_type", value="optional_value")`
                                     ^^^^^^^^^^^^^^^^^^^^^^^^^
SyntaxError: invalid syntax
Both GOOGLE_API_KEY and GEMINI_API_KEY are set. Using GOOGLE_API_KEY.
ğŸš€ Triggering agent with config: /home/runner/work/build_qa_automation/build_qa_automation/projects/https___www_microsoft_com__regression/config.json
ğŸš€ Starting Autonomous Pipeline for https___www_microsoft_com__regression...

[Step 0/7] ğŸ“‹ Strategic Test Planning...
âš ï¸ Pre-Planning Failed: attempted relative import with no known parent package
ğŸ“ Failure logged to knowledge/failures.json

[Step 1/7] ğŸ—ºï¸  Exploring & Mining (Plan-Guided)...

[Step 2/7] ğŸ“– Updating Knowledge Bank...
ğŸ“– Knowledge Bank updated for www.microsoft.com

[Step 3/7] ğŸ’» Generating Robust Code...
âŒ Code Generation Failed!
ğŸ“ Failure logged to knowledge/failures.json
âœ… POM Structure generated: projects/https___www_microsoft_com__regression/outputs/pom_structure.json
{
  "base_url": "https://www.microsoft.com/",
  "workflow": "Autonomous smoke test: Navigate site, explore main features, verify key elements",
  "pages": [
    {
      "name": "EnUsMicrosoft365Page",
      "url": "/en-us/microsoft-365",
      "locators": [
        {
          "name": "microsoft_365_link",
          "selector": "get_by_role(\"link\", name=\"Microsoft 365\")",
          "element": {
            "tag": "a",
            "text": "Microsoft 365",
            "role": ""
          }
        },
        {
          "name": "login_button",
          "selector": "",
          "element": {
            "tag": "",
            "text": "",
            "role": ""
          }
        },
        {
          "name": "products_button",
          "selector": "get_by_role(\"button\", name=\"Products\")",
          "element": {
            "tag": "button",
            "text": "Products",
            "role": ""
          }
        },
        {
          "name": "resources_button",
          "selector": "get_by_role(\"button\", name=\"Resources\")",
          "element": {
            "tag": "button",
            "text": "Resources",
            "role": ""
          }
        },
        {
          "name": "see_plans_and_pricing_for_microsoft_365_link",
          "selector": "get_by_text('See plans and pricing for Microsoft 365')",
          "element": {
            "tag": "a",
            "text": "See plans and pricing for Microsoft 365",
            "role": ""
          }
        },
        {
          "name": "support_button",
          "selector": "get_by_text('Support')",
          "element": {
            "tag": "button",
            "text": "Support",
            "role": ""
          }
        },
        {
          "name": "for_individuals_button",
          "selector": "get_by_text('For individuals')",
          "element": {
            "tag": "button",
            "text": "For individuals",
            "role": ""
          }
        },
        {
          "name": "plans_and_pricing_link",
          "selector": "get_by_text('Plans and pricing')",
          "element": {
            "tag": "a",
            "text": "Plans and pricing",
            "role": ""
          }
        }
      ],
      "actions": [
        {
          "name": "click_microsoft_365_link",
          "steps": [
            {
              "step": 0,
              "action": "click",
              "locator_name": "microsoft_365_link",
              "value": null,
              "thought": "The goal is to navigate the site and explore main features. I will start by clicking on the first main navigation link, which is 'Microsoft 365'. I will skip login since no test data is available."
            }
          ],
          "params": ""
        },
        {
          "name": "click_login_button",
          "steps": [
            {
              "step": 1,
              "action": "click",
              "locator_name": "login_button",
              "value": "See plans and pricing",
              "thought": "I am on the login screen of Microsoft 365. The goal is to navigate the site and explore main features. Since I don't have any login credentials in `test_data`, I will skip logging in and instead explore publicly available features, such as the pricing page. The page context mentions a 'See plans and pricing' button."
            }
          ],
          "params": ""
        },
        {
          "name": "click_products_button",
          "steps": [
            {
              "step": 2,
              "action": "click",
              "locator_name": "products_button",
              "value": null,
              "thought": "The goal is to autonomously smoke test the Microsoft 365 website by navigating the site and exploring the main features. I am currently on the homepage. The previous action failed, so I need to find a different element to interact with. Since I am not logged in and do not have credentials, I will start by exploring the 'Products' menu to explore the features. I'll click on the 'Products' button to see a list of available Microsoft products."
            }
          ],
          "params": ""
        },
        {
          "name": "click_resources_button",
          "steps": [
            {
              "step": 3,
              "action": "click",
              "locator_name": "resources_button",
              "value": null,
              "thought": "The goal is to explore the main features of the site. I have already clicked on 'Microsoft 365' and 'Products'. Now, I will try clicking on 'Resources' button to further explore the site's features."
            }
          ],
          "params": ""
        },
        {
          "name": "click_see_plans_and_pricing_for_microsoft_365_link",
          "steps": [
            {
              "step": 4,
              "action": "click",
              "locator_name": "see_plans_and_pricing_for_microsoft_365_link",
              "value": null,
              "thought": "The page is a login screen for Microsoft 365. The goal is to navigate and explore the site. Since there are no credentials available, I will skip the sign-in process and explore publicly available options. There's a 'Plans and pricing' link available, which I can use to explore the website's features."
            }
          ],
          "params": ""
        },
        {
          "name": "click_support_button",
          "steps": [
            {
              "step": 5,
              "action": "click",
              "locator_name": "support_button",
              "value": null,
              "thought": "The goal is to navigate the site and explore the main features. I've already clicked on 'Products', 'Resources', and 'See plans and pricing for Microsoft 365'. Now I will click the 'Support' button to explore another main feature."
            }
          ],
          "params": ""
        },
        {
          "name": "click_for_individuals_button",
          "steps": [
            {
              "step": 6,
              "action": "click",
              "locator_name": "for_individuals_button",
              "value": null,
              "thought": "I'm on the Microsoft 365 home page. I've already clicked Products, Resources, the plans and pricing link, and Support. Next I will click the 'For individuals' button to explore that section of the site."
            }
          ],
          "params": ""
        },
        {
          "name": "click_plans_and_pricing_link",
          "steps": [
            {
              "step": 7,
              "action": "click",
              "locator_name": "plans_and_pricing_link",
              "value": null,
              "thought": "The goal is to smoke test the site. I've already clicked several buttons on the page. I'm now going to click the 'Plans and pricing' link to see the available plans."
            }
          ],
          "params": ""
        }
      ]
    },
    {
      "name": "EnUsMicrosoft365BusinessMicrosoft365PlansAndPricingPage",
      "url": "/en-us/microsoft-365/business/microsoft-365-plans-and-pricing",
      "locators": [
        {
          "name": "products_button",
          "selector": "get_by_text('Products')",
          "element": {
            "tag": "button",
            "text": "Products",
            "role": ""
          }
        }
      ],
      "actions": [
        {
          "name": "click_products_button",
          "steps": [
            {
              "step": 8,
              "action": "click",
              "locator_name": "products_button",
              "value": null,
              "thought": "I have clicked several links and buttons already. The page is still the same and there are no credentials available. I will explore the 'Products' menu again."
            }
          ],
          "params": ""
        }
      ]
    }
  ],
  "tests": [
    {
      "name": "test_workflow_execution",
      "description": "Autonomous smoke test: Navigate site, explore main features, verify key elements",
      "steps_description": [
        "The goal is to navigate the site and explore main features. I will start by clicking on the first main navigation link, which is 'Microsoft 365'. I will skip login since no test data is available.",
        "I am on the login screen of Microsoft 365. The goal is to navigate the site and explore main features. Since I don't have any login credentials in `test_data`, I will skip logging in and instead explore publicly available features, such as the pricing page. The page context mentions a 'See plans and pricing' button.",
        "The goal is to autonomously smoke test the Microsoft 365 website by navigating the site and exploring the main features. I am currently on the homepage. The previous action failed, so I need to find a different element to interact with. Since I am not logged in and do not have credentials, I will start by exploring the 'Products' menu to explore the features. I'll click on the 'Products' button to see a list of available Microsoft products.",
        "The goal is to explore the main features of the site. I have already clicked on 'Microsoft 365' and 'Products'. Now, I will try clicking on 'Resources' button to further explore the site's features.",
        "The page is a login screen for Microsoft 365. The goal is to navigate and explore the site. Since there are no credentials available, I will skip the sign-in process and explore publicly available options. There's a 'Plans and pricing' link available, which I can use to explore the website's features.",
        "The goal is to navigate the site and explore the main features. I've already clicked on 'Products', 'Resources', and 'See plans and pricing for Microsoft 365'. Now I will click the 'Support' button to explore another main feature.",
        "I'm on the Microsoft 365 home page. I've already clicked Products, Resources, the plans and pricing link, and Support. Next I will click the 'For individuals' button to explore that section of the site.",
        "The goal is to smoke test the site. I've already clicked several buttons on the page. I'm now going to click the 'Plans and pricing' link to see the available plans.",
        "I have clicked several links and buttons already. The page is still the same and there are no credentials available. I will explore the 'Products' menu again."
      ],
      "page_objects": [
        {
          "class_name": "EnUsMicrosoft365Page",
          "var_name": "en_us_microsoft365_page",
          "goto": true,
          "description": "Page object for EnUsMicrosoft365"
        },
        {
          "class_name": "EnUsMicrosoft365BusinessMicrosoft365PlansAndPricingPage",
          "var_name": "en_us_microsoft365_business_microsoft365_plans_and_pricing_page",
          "goto": false,
          "description": "Page object for EnUsMicrosoft365BusinessMicrosoft365PlansAndPricing"
        }
      ],
      "actions": [
        {
          "code": "en_us_microsoft365_page.click_microsoft_365_link()",
          "comment": "The goal is to navigate the site and explore main features. "
        },
        {
          "code": "en_us_microsoft365_page.click_login_button(\"See plans and pricing\")",
          "comment": "I am on the login screen of Microsoft 365. The goal is to na"
        },
        {
          "code": "en_us_microsoft365_page.click_products_button()",
          "comment": "The goal is to autonomously smoke test the Microsoft 365 web"
        },
        {
          "code": "en_us_microsoft365_page.click_resources_button()",
          "comment": "The goal is to explore the main features of the site. I have"
        },
        {
          "code": "en_us_microsoft365_page.click_see_plans_and_pricing_for_microsoft_365_link()",
          "comment": "The page is a login screen for Microsoft 365. The goal is to"
        },
        {
          "code": "en_us_microsoft365_page.click_support_button()",
          "comment": "The goal is to navigate the site and explore the main featur"
        },
        {
          "code": "en_us_microsoft365_page.click_for_individuals_button()",
          "comment": "I'm on the Microsoft 365 home page. I've already clicked Pro"
        },
        {
          "code": "en_us_microsoft365_page.click_plans_and_pricing_link()",
          "comment": "The goal is to smoke test the site. I've already clicked sev"
        },
        {
          "code": "en_us_microsoft365_business_microsoft365_plans_and_pricing_page.click_products_button()",
          "comment": "I have clicked several links and buttons already. The page i"
        }
      ],
      "assertions": [
        {
          "code": "expect(page).to_have_url(re.compile(\".*\"))",
          "comment": "Verify page navigation successful"
        }
      ]
    }
  ]
}
âœ… Generated: projects/https___www_microsoft_com__regression/pages/base_page.py
âœ… Generated: projects/https___www_microsoft_com__regression/pages/en_us_microsoft365_page.py
âœ… Generated: projects/https___www_microsoft_com__regression/pages/en_us_microsoft365_business_microsoft365_plans_and_pricing_page.py
âœ… Generated: projects/https___www_microsoft_com__regression/pages/__init__.py
âœ… Generated: projects/https___www_microsoft_com__regression/tests/e2e/test_main.py

ğŸ‰ POM Generation Complete!
ğŸ“ Pages: 2 files
ğŸ“ Tests: 1 files
============================= test session starts ==============================
platform linux -- Python 3.11.14, pytest-9.0.2, pluggy-1.6.0 -- /opt/hostedtoolcache/Python/3.11.14/x64/bin/python
cachedir: .pytest_cache
metadata: {'Python': '3.11.14', 'Platform': 'Linux-6.11.0-1018-azure-x86_64-with-glibc2.39', 'Packages': {'pytest': '9.0.2', 'pluggy': '1.6.0'}, 'Plugins': {'html': '4.1.1', 'base-url': '2.1.0', 'anyio': '4.12.0', 'playwright': '0.7.2', 'metadata': '3.1.1', 'langsmith': '0.6.0'}, 'CI': 'true', 'JAVA_HOME': '/usr/lib/jvm/temurin-17-jdk-amd64', 'Base URL': ''}
rootdir: /home/runner/work/build_qa_automation/build_qa_automation
plugins: html-4.1.1, base-url-2.1.0, anyio-4.12.0, playwright-0.7.2, metadata-3.1.1, langsmith-0.6.0
collecting ... collected 1 item

projects/https___www_microsoft_com__regression/tests/e2e/test_main.py::test_workflow_execution[chromium] FAILED [100%]

=================================== FAILURES ===================================
______________________ test_workflow_execution[chromium] _______________________

page = <Page url='https://www.microsoft.com/en-us/'>

    def test_workflow_execution(page: Page):
        """
        Autonomous smoke test: Navigate site, explore main features, verify key elements
    
        Test Steps:
    
        1. The goal is to navigate the site and explore main features. I will start by clicking on the first main navigation link, which is 'Microsoft 365'. I will skip login since no test data is available.
    
        2. I am on the login screen of Microsoft 365. The goal is to navigate the site and explore main features. Since I don't have any login credentials in `test_data`, I will skip logging in and instead explore publicly available features, such as the pricing page. The page context mentions a 'See plans and pricing' button.
    
        3. The goal is to autonomously smoke test the Microsoft 365 website by navigating the site and exploring the main features. I am currently on the homepage. The previous action failed, so I need to find a different element to interact with. Since I am not logged in and do not have credentials, I will start by exploring the 'Products' menu to explore the features. I'll click on the 'Products' button to see a list of available Microsoft products.
    
        4. The goal is to explore the main features of the site. I have already clicked on 'Microsoft 365' and 'Products'. Now, I will try clicking on 'Resources' button to further explore the site's features.
    
        5. The page is a login screen for Microsoft 365. The goal is to navigate and explore the site. Since there are no credentials available, I will skip the sign-in process and explore publicly available options. There's a 'Plans and pricing' link available, which I can use to explore the website's features.
    
        6. The goal is to navigate the site and explore the main features. I've already clicked on 'Products', 'Resources', and 'See plans and pricing for Microsoft 365'. Now I will click the 'Support' button to explore another main feature.
    
        7. I'm on the Microsoft 365 home page. I've already clicked Products, Resources, the plans and pricing link, and Support. Next I will click the 'For individuals' button to explore that section of the site.
    
        8. The goal is to smoke test the site. I've already clicked several buttons on the page. I'm now going to click the 'Plans and pricing' link to see the available plans.
    
        9. I have clicked several links and buttons already. The page is still the same and there are no credentials available. I will explore the 'Products' menu again.
    
        """
        # ==================== ARRANGE ====================
        # Initialize page objects
    
        en_us_microsoft365_page = EnUsMicrosoft365Page(page)  # Page object for EnUsMicrosoft365
    
    
        en_us_microsoft365_business_microsoft365_plans_and_pricing_page = EnUsMicrosoft365BusinessMicrosoft365PlansAndPricingPage(page)  # Page object for EnUsMicrosoft365BusinessMicrosoft365PlansAndPricing
    
    
    
        # ==================== ACT ====================
        # Execute workflow actions
    
>       en_us_microsoft365_page.click_microsoft_365_link()  # The goal is to navigate the site and explore main features.
       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

projects/https___www_microsoft_com__regression/tests/e2e/test_main.py:65: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
projects/https___www_microsoft_com__regression/pages/en_us_microsoft365_page.py:62: in click_microsoft_365_link
    self.do_click(self.microsoft_365_link)  # Click microsoft_365_link
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
projects/https___www_microsoft_com__regression/pages/base_page.py:20: in do_click
    locator.click(timeout=5000) # Fast fail first
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^
/opt/hostedtoolcache/Python/3.11.14/x64/lib/python3.11/site-packages/playwright/sync_api/_generated.py:15637: in click
    self._sync(
/opt/hostedtoolcache/Python/3.11.14/x64/lib/python3.11/site-packages/playwright/_impl/_locator.py:162: in click
    return await self._frame._click(self._selector, strict=True, **params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/opt/hostedtoolcache/Python/3.11.14/x64/lib/python3.11/site-packages/playwright/_impl/_frame.py:566: in _click
    await self._channel.send("click", self._timeout, locals_to_params(locals()))
/opt/hostedtoolcache/Python/3.11.14/x64/lib/python3.11/site-packages/playwright/_impl/_connection.py:69: in send
    return await self._connection.wrap_api_call(
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <playwright._impl._connection.Connection object at 0x7f83c5af0e50>
cb = <function Channel.send.<locals>.<lambda> at 0x7f83c561c220>
is_internal = False, title = None

    async def wrap_api_call(
        self, cb: Callable[[], Any], is_internal: bool = False, title: str = None
    ) -> Any:
        if self._api_zone.get():
            return await cb()
        task = asyncio.current_task(self._loop)
        st: List[inspect.FrameInfo] = getattr(
            task, "__pw_stack__", None
        ) or inspect.stack(0)
    
        parsed_st = _extract_stack_trace_information_from_stack(st, is_internal, title)
        self._api_zone.set(parsed_st)
        try:
            return await cb()
        except Exception as error:
>           raise rewrite_error(error, f"{parsed_st['apiName']}: {error}") from None
E           playwright._impl._errors.Error: Locator.click: Error: strict mode violation: get_by_role("link", name="Microsoft 365") resolved to 7 elements:
E               1) <a id="shellmenu_0" class="c-uhf-nav-link" href="https://www.microsoft.com/microsoft-365" data-m="{"cN":"CatNav_M365_nav","id":"n1c6c4c1m1r1a1","sN":1,"aN":"c6c4c1m1r1a1"}">Microsoft 365</a> aka get_by_role("link", name="Microsoft 365", exact=True)
E               2) <a target="_self" data-bi-sn="1" data-bi-bhvr="0" data-bi-tags="{}" data-bi-cn="Get offer" data-bi-ecn="Get offer" aria-label="Get Microsoft 365 Premium offer" data-bi-compnm="ReimagineHeroFeaturedSlider" data-bi-hn="Start Microsoft 365 Premium today for 50% off" data-bi-ehn="Start Microsoft 365 Premium today for 50% off" data-bi-view=" | Start Microsoft 365 Premium today for 50% off" href="https://www.microsoft.com/en-us/microsoft-365/p/microsoft-365-premium/cfq7ttc11z3q?icid=mscom_marcom_H1a_M3â€¦>â†µâ†µ    â†µâ†µ    â†µ      Get offerâ†µ    â†µâ†µ    â†µ  </a> aka get_by_role("link", name="Get Microsoft 365 Premium")
E               3) <a target="_self" data-bi-sn="1" data-bi-bhvr="0" data-bi-tags="{}" data-bi-ct="Card Link" data-bi-cn="Learn more" data-bi-ecn="Learn more" data-bi-ehn="For business" data-bi-view=" | For business" data-bi-hn="Microsoft 365 Copilot" data-bi-compnm="ReimagineFeatured" aria-label="Learn more about Microsoft 365 Copilot" href="https://www.microsoft.com/en-us/microsoft-365-copilot?icid=mscom_marcom_CPW2a_M365forBusiness_Copilot">â†µâ†µ    â†µâ†µ    â†µ      Learn moreâ†µ    â†µâ†µ    â†µ  </a> aka get_by_role("link", name="Learn more about Microsoft")
E               4) <a class="c-uhff-link" aria-label="Microsoft 365 Education Education" href="https://www.microsoft.com/en-us/education/products/microsoft-365" data-m="{"cN":"Footer_Education_Microsoft365Education_nav","id":"n4c3c1c1m1r1a2","sN":4,"aN":"c3c1c1m1r1a2"}">Microsoft 365 Education</a> aka get_by_role("link", name="Microsoft 365 Education")
E               5) <a class="c-uhff-link" aria-label="Microsoft 365 Business" href="https://www.microsoft.com/en-us/microsoft-365/business" data-m="{"cN":"Footer_Business_M365_nav","id":"n3c4c1c1m1r1a2","sN":3,"aN":"c4c1c1m1r1a2"}">Microsoft 365</a> aka get_by_role("link", name="Microsoft 365 Business")
E               6) <a class="c-uhff-link" aria-label="Microsoft 365 Copilot Business" href="https://www.microsoft.com/en-us/microsoft-365-copilot?icid=DSM_Footer_Microsoft365Copilot" data-m="{"cN":"Footer_CopilotMicrosoft365_nav","id":"n6c4c1c1m1r1a2","sN":6,"aN":"c4c1c1m1r1a2"}">Microsoft 365 Copilot</a> aka get_by_role("link", name="Microsoft 365 Copilot Business")
E               7) <a data-bi-bhvr="230" data-bi-ct="Tab Nav" data-bi-compnm="Quicklinks" href="https://www.microsoft.com/EN-US/microsoft-365/compare-all-microsoft-365-products?icid=MSCOM_QL_M365">â€¦</a> aka get_by_role("link", name="Choose your Microsoft")
E           
E           Call log:
E             - waiting for get_by_role("link", name="Microsoft 365")

/opt/hostedtoolcache/Python/3.11.14/x64/lib/python3.11/site-packages/playwright/_impl/_connection.py:559: Error
- Generated html report: file:///home/runner/work/build_qa_automation/build_qa_automation/projects/https___www_microsoft_com__regression/outputs/pytest_report.html -
=========================== short test summary info ============================
FAILED projects/https___www_microsoft_com__regression/tests/e2e/test_main.py::test_workflow_execution[chromium] - playwright._impl._errors.Error: Locator.click: Error: strict mode violation: get_by_role("link", name="Microsoft 365") resolved to 7 elements:
    1) <a id="shellmenu_0" class="c-uhf-nav-link" href="https://www.microsoft.com/microsoft-365" data-m="{"cN":"CatNav_M365_nav","id":"n1c6c4c1m1r1a1","sN":1,"aN":"c6c4c1m1r1a1"}">Microsoft 365</a> aka get_by_role("link", name="Microsoft 365", exact=True)
    2) <a target="_self" data-bi-sn="1" data-bi-bhvr="0" data-bi-tags="{}" data-bi-cn="Get offer" data-bi-ecn="Get offer" aria-label="Get Microsoft 365 Premium offer" data-bi-compnm="ReimagineHeroFeaturedSlider" data-bi-hn="Start Microsoft 365 Premium today for 50% off" data-bi-ehn="Start Microsoft 365 Premium today for 50% off" data-bi-view=" | Start Microsoft 365 Premium today for 50% off" href="https://www.microsoft.com/en-us/microsoft-365/p/microsoft-365-premium/cfq7ttc11z3q?icid=mscom_marcom_H1a_M3â€¦>â†µâ†µ    â†µâ†µ    â†µ      Get offerâ†µ    â†µâ†µ    â†µ  </a> aka get_by_role("link", name="Get Microsoft 365 Premium")
    3) <a target="_self" data-bi-sn="1" data-bi-bhvr="0" data-bi-tags="{}" data-bi-ct="Card Link" data-bi-cn="Learn more" data-bi-ecn="Learn more" data-bi-ehn="For business" data-bi-view=" | For business" data-bi-hn="Microsoft 365 Copilot" data-bi-compnm="ReimagineFeatured" aria-label="Learn more about Microsoft 365 Copilot" href="https://www.microsoft.com/en-us/microsoft-365-copilot?icid=mscom_marcom_CPW2a_M365forBusiness_Copilot">â†µâ†µ    â†µâ†µ    â†µ      Learn moreâ†µ    â†µâ†µ    â†µ  </a> aka get_by_role("link", name="Learn more about Microsoft")
    4) <a class="c-uhff-link" aria-label="Microsoft 365 Education Education" href="https://www.microsoft.com/en-us/education/products/microsoft-365" data-m="{"cN":"Footer_Education_Microsoft365Education_nav","id":"n4c3c1c1m1r1a2","sN":4,"aN":"c3c1c1m1r1a2"}">Microsoft 365 Education</a> aka get_by_role("link", name="Microsoft 365 Education")
    5) <a class="c-uhff-link" aria-label="Microsoft 365 Business" href="https://www.microsoft.com/en-us/microsoft-365/business" data-m="{"cN":"Footer_Business_M365_nav","id":"n3c4c1c1m1r1a2","sN":3,"aN":"c4c1c1m1r1a2"}">Microsoft 365</a> aka get_by_role("link", name="Microsoft 365 Business")
    6) <a class="c-uhff-link" aria-label="Microsoft 365 Copilot Business" href="https://www.microsoft.com/en-us/microsoft-365-copilot?icid=DSM_Footer_Microsoft365Copilot" data-m="{"cN":"Footer_CopilotMicrosoft365_nav","id":"n6c4c1c1m1r1a2","sN":6,"aN":"c4c1c1m1r1a2"}">Microsoft 365 Copilot</a> aka get_by_role("link", name="Microsoft 365 Copilot Business")
    7) <a data-bi-bhvr="230" data-bi-ct="Tab Nav" data-bi-compnm="Quicklinks" href="https://www.microsoft.com/EN-US/microsoft-365/compare-all-microsoft-365-products?icid=MSCOM_QL_M365">â€¦</a> aka get_by_role("link", name="Choose your Microsoft")

Call log:
  - waiting for get_by_role("link", name="Microsoft 365")
============================== 1 failed in 2.36s ===============================
